<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1214px" preserveAspectRatio="none" style="width:954px;height:1214px;background:#FFFFFF;" version="1.1" viewBox="0 0 954 1214" width="954px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="613.6002" style="stroke:#000000;stroke-width:1.5;" width="926.5" x="10" y="290.6"/><rect fill="none" height="381.2001" style="stroke:#000000;stroke-width:1.5;" width="565.5" x="361" y="456.8001"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="53" x2="53" y1="40.7999" y2="1175.1504"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="408.5" x2="408.5" y1="40.7999" y2="1175.1504"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="567" x2="567" y1="40.7999" y2="1175.1504"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="764.5" x2="764.5" y1="40.7999" y2="1175.1504"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="860.5" x2="860.5" y1="40.7999" y2="1175.1504"/><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="20" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="27" y="29.0059">S3Client</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="20" y="1174.1504"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="27" y="1194.1563">S3Client</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="373.5" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="380.5" y="29.0059">Gateway</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="373.5" y="1174.1504"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="380.5" y="1194.1563">Gateway</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="541" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="548" y="29.0059">Uplink</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="541" y="1174.1504"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="548" y="1194.1563">Uplink</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="732.5" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="739.5" y="29.0059">Satellite</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="732.5" y="1174.1504"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="739.5" y="1194.1563">Satellite</text><rect fill="#E2E2F0" height="30.7999" style="stroke:#181818;stroke-width:0.5;" width="105" x="810.5" y="5"/><rect fill="#E2E2F0" height="30.7999" style="stroke:#181818;stroke-width:0.5;" width="105" x="806.5" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="813.5" y="29.0059">StorageNodes</text><rect fill="#E2E2F0" height="30.7999" style="stroke:#181818;stroke-width:0.5;" width="105" x="810.5" y="1174.1504"/><rect fill="#E2E2F0" height="30.7999" style="stroke:#181818;stroke-width:0.5;" width="105" x="806.5" y="1178.1504"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="813.5" y="1198.1563">StorageNodes</text><polygon fill="#181818" points="396.5,68.3999,406.5,72.3999,396.5,76.3999,400.5,72.3999" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="53.5" x2="402.5" y1="72.3999" y2="72.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="60.5" y="66.8769">PUT /bucket/dest?uploads</text><polygon fill="#181818" points="555.5,116.6,565.5,120.6,555.5,124.6,559.5,120.6" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="408.5" x2="561.5" y1="120.6" y2="120.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="415.5" y="115.077">BeginUpload (multipart)</text><path d="M338,85.3999 L338,141.3999 L403,141.3999 L403,95.3999 L393,85.3999 L338,85.3999 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M393,85.3999 L393,95.3999 L403,95.3999 L393,85.3999 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="344" y="102.477">Bucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="344" y="118.077">Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="344" y="133.677">Expires</text><polygon fill="#181818" points="752.5,164.8,762.5,168.8,752.5,172.8,756.5,168.8" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="567.5" x2="758.5" y1="168.8" y2="168.8"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="574.5" y="163.277">BeginObjectRequest</text><polygon fill="#181818" points="578.5,197.4,568.5,201.4,578.5,205.4,574.5,201.4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="572.5" x2="763.5" y1="201.4" y2="201.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="584.5" y="195.877">BeginObjectResponse</text><path d="M769,181.8 L769,206.8 L845,206.8 L845,191.8 L835,181.8 L769,181.8 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M835,181.8 L835,191.8 L845,191.8 L835,181.8 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="775" y="198.877">StreamID</text><polygon fill="#181818" points="419.5,233,409.5,237,419.5,241,415.5,237" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="413.5" x2="566.5" y1="237" y2="237"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="425.5" y="231.477">BeginUpload return</text><path d="M572,217.4 L572,242.4 L648,242.4 L648,227.4 L638,217.4 L572,217.4 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M638,217.4 L638,227.4 L648,227.4 L638,217.4 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="578" y="234.477">StreamID</text><polygon fill="#181818" points="64.5,268.6,54.5,272.6,64.5,276.6,60.5,272.6" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="407.5" y1="272.6" y2="272.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="70.5" y="267.077">200 response</text><path d="M413,253 L413,278 L509,278 L509,263 L499,253 L413,253 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M499,253 L499,263 L509,263 L499,253 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="419" y="270.077">&lt;UploadId /&gt;</text><path d="M10,290.6 L169,290.6 L169,298.2001 L159,308.2001 L10,308.2001 L10,290.6 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="613.6002" style="stroke:#000000;stroke-width:1.5;" width="926.5" x="10" y="290.6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114" x="25" y="303.677">loop for every part</text><polygon fill="#181818" points="396.5,325.8001,406.5,329.8001,396.5,333.8001,400.5,329.8001" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="53.5" x2="402.5" y1="329.8001" y2="329.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331" x="60.5" y="324.2771">PUT /bucket/dest?partNumber=1&amp;uploadId=7tKsLOJgNs</text><polygon fill="#181818" points="555.5,381.8001,565.5,385.8001,555.5,389.8001,559.5,385.8001" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="408.5" x2="561.5" y1="385.8001" y2="385.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="415.5" y="380.2771">UploadPart</text><path d="M313,342.8001 L313,414.8001 L403,414.8001 L403,352.8001 L393,342.8001 L313,342.8001 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M393,342.8001 L393,352.8001 L403,352.8001 L393,342.8001 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="319" y="359.8771">Bucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="319" y="375.4771">Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="319" y="391.0771">UploadID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="319" y="406.6771">PartNumber</text><polygon fill="#181818" points="555.5,437.8001,565.5,441.8001,555.5,445.8001,559.5,441.8001" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="408.5" x2="561.5" y1="441.8001" y2="441.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="415.5" y="436.2771">UploadPart.write</text><path d="M361,456.8001 L549,456.8001 L549,464.4001 L539,474.4001 L361,474.4001 L361,456.8001 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="381.2001" style="stroke:#000000;stroke-width:1.5;" width="565.5" x="361" y="456.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143" x="376" y="469.8771">loop for every segment</text><polygon fill="#181818" points="752.5,502.8002,762.5,506.8002,752.5,510.8002,756.5,506.8002" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="567.5" x2="758.5" y1="506.8002" y2="506.8002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="574.5" y="501.2772">SegmentBeginRequest</text><path d="M486,479.4001 L486,520.4001 L562,520.4001 L562,489.4001 L552,479.4001 L486,479.4001 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M552,479.4001 L552,489.4001 L562,489.4001 L552,479.4001 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="492" y="496.4772">StreamID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="492" y="512.0772">Position</text><polygon fill="#181818" points="578.5,561.8002,568.5,565.8002,578.5,569.8002,574.5,565.8002" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="572.5" x2="763.5" y1="565.8002" y2="565.8002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="584.5" y="560.2772">SegmentBeginResponse</text><path d="M769,530.6002 L769,586.6002 L911,586.6002 L911,540.6002 L901,530.6002 L769,530.6002 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M901,530.6002 L901,540.6002 L911,540.6002 L901,530.6002 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="775" y="547.6772">SegmentID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="775" y="563.2772">OrderLimits</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="775" y="578.8772">PiecePrivateKey</text><polygon fill="#181818" points="849,610.0002,859,614.0002,849,618.0002,853,614.0002" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="567.5" x2="855" y1="614.0002" y2="614.0002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="574.5" y="608.4772">PieceUploadRequest</text><polygon fill="#181818" points="578.5,639.6002,568.5,643.6002,578.5,647.6002,574.5,643.6002" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="572.5" x2="860" y1="643.6002" y2="643.6002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="584.5" y="638.0772">PieceUploadResponse</text><polygon fill="#181818" points="752.5,695.6003,762.5,699.6003,752.5,703.6003,756.5,699.6003" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="567.5" x2="758.5" y1="699.6003" y2="699.6003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="574.5" y="694.0773">SegmentCommitRequest</text><path d="M371,656.6002 L371,728.6002 L562,728.6002 L562,666.6002 L552,656.6002 L371,656.6002 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M552,656.6002 L552,666.6002 L562,666.6002 L552,656.6002 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="377" y="673.6773">SegmentID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="377" y="689.2773">EncryptedKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="377" y="704.8773">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="377" y="720.4773">[]SegmentPieceUploadResult</text><polygon fill="#181818" points="578.5,751.6003,568.5,755.6003,578.5,759.6003,574.5,755.6003" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="572.5" x2="763.5" y1="755.6003" y2="755.6003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="584.5" y="750.0773">SegmentCommitResponse</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="361" x2="926.5" y1="764.6003" y2="764.6003"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="47" x="366" y="774.8192">[if inline]</text><polygon fill="#181818" points="752.5,796.4002,762.5,800.4002,752.5,804.4002,756.5,800.4002" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="567.5" x2="758.5" y1="800.4002" y2="800.4002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="574.5" y="794.8772">SegmentMakeInlineRequest</text><polygon fill="#181818" points="578.5,826.0002,568.5,830.0002,578.5,834.0002,574.5,830.0002" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="572.5" x2="763.5" y1="830.0002" y2="830.0002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="584.5" y="824.4772">SegmentMakeInlineResponse</text><polygon fill="#181818" points="419.5,862.6003,409.5,866.6003,419.5,870.6003,415.5,866.6003" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="413.5" x2="566.5" y1="866.6003" y2="866.6003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="425.5" y="861.0773">UploadPart return</text><polygon fill="#181818" points="64.5,892.2003,54.5,896.2003,64.5,900.2003,60.5,896.2003" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="407.5" y1="896.2003" y2="896.2003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="70.5" y="890.6773">200 response</text><polygon fill="#181818" points="396.5,928.8003,406.5,932.8003,396.5,936.8003,400.5,932.8003" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="53.5" x2="402.5" y1="932.8003" y2="932.8003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="60.5" y="927.2773">POST /bucket/dest?uploadId=7tKsLOJgNs</text><polygon fill="#181818" points="555.5,984.8003,565.5,988.8003,555.5,992.8003,559.5,988.8003" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="408.5" x2="561.5" y1="988.8003" y2="988.8003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="415.5" y="983.2773">CommitUpload</text><path d="M283,945.8003 L283,1017.8003 L403,1017.8003 L403,955.8003 L393,945.8003 L283,945.8003 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M393,945.8003 L393,955.8003 L403,955.8003 L393,945.8003 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="289" y="962.8773">Bucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="289" y="978.4773">Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="289" y="994.0773">UploadID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="289" y="1009.6773">CustomMetadata</text><polygon fill="#181818" points="752.5,1064.3504,762.5,1068.3504,752.5,1072.3504,756.5,1068.3504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="567.5" x2="758.5" y1="1068.3504" y2="1068.3504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="574.5" y="1062.8274">ObjectCommitRequest</text><path d="M385,1028.2003 L385,1071.2003 L562,1071.2003 L562,1038.2003 L552,1028.2003 L385,1028.2003 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M552,1028.2003 L552,1038.2003 L562,1038.2003 L552,1028.2003 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="391" y="1045.2773">StreamID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="391" y="1062.8274">CustomMetadata</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="53" x="494" y="1063.1004">encypted</text><path d="M769,1029.1753 L769,1070.1753 L947,1070.1753 L947,1039.1753 L937,1029.1753 L769,1029.1753 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M937,1029.1753 L937,1039.1753 L947,1039.1753 L937,1029.1753 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="775" y="1046.2523">Change object status from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="775" y="1061.8524">pending to committed</text><polygon fill="#181818" points="578.5,1093.9504,568.5,1097.9504,578.5,1101.9504,574.5,1097.9504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="572.5" x2="763.5" y1="1097.9504" y2="1097.9504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="584.5" y="1092.4274">ObjectCommitResponse</text><polygon fill="#181818" points="419.5,1123.5504,409.5,1127.5504,419.5,1131.5504,415.5,1127.5504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="413.5" x2="566.5" y1="1127.5504" y2="1127.5504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="425.5" y="1122.0274">CommitUpload return</text><polygon fill="#181818" points="64.5,1153.1504,54.5,1157.1504,64.5,1161.1504,60.5,1157.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="407.5" y1="1157.1504" y2="1157.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="70.5" y="1151.6274">200 response</text><!--MD5=[2b254ec7af816ea9e80f1e0ea00b72aa]
@startuml

S3Client -> Gateway: PUT /bucket/dest?uploads

Gateway -> Uplink: BeginUpload (multipart)
note left
    Bucket
    Key
    Expires
end note

Uplink -> Satellite: BeginObjectRequest

Uplink <- - Satellite: BeginObjectResponse
note right
    StreamID
end note

Gateway <- - Uplink: BeginUpload return
note right
    StreamID
end note

S3Client <- - Gateway: 200 response
note right
    <UploadId />
end note

group loop for every part
    S3Client -> Gateway: PUT /bucket/dest?partNumber=1&uploadId=7tKsLOJgNs

    Gateway -> Uplink: UploadPart
    note left
        Bucket
        Key
        UploadID
        PartNumber
    end note

    Gateway -> Uplink: UploadPart.write

    group loop for every segment

        Uplink -> Satellite: SegmentBeginRequest
        note left
            StreamID
            Position
        end note

        Uplink <- - Satellite: SegmentBeginResponse
        note right
            SegmentID              
            OrderLimits
            PiecePrivateKey
        end note

        collections StorageNodes

        Uplink -> StorageNodes: PieceUploadRequest
        Uplink <- - StorageNodes: PieceUploadResponse

        Uplink -> Satellite: SegmentCommitRequest
        note left
            SegmentID
            EncryptedKey
            Size
            []SegmentPieceUploadResult
        end note

        Uplink <- - Satellite: SegmentCommitResponse

    else if inline
        Uplink -> Satellite: SegmentMakeInlineRequest
        Uplink <- - Satellite: SegmentMakeInlineResponse
    end

    Gateway <- - Uplink: UploadPart return

    S3Client <- - Gateway: 200 response
end

S3Client -> Gateway: POST /bucket/dest?uploadId=7tKsLOJgNs

Gateway -> Uplink: CommitUpload
note left
    Bucket
    Key
    UploadID
    CustomMetadata
end note

Uplink -> Satellite: ObjectCommitRequest
note left
    StreamID
    CustomMetadata //encypted//
end note
note right #lightgreen
    Change object status from 
    pending to committed
end note

Uplink <- - Satellite: ObjectCommitResponse

Gateway <- - Uplink: CommitUpload return

S3Client <- - Gateway: 200 response

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>